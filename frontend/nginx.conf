server {
    listen 80;
    server_name localhost;

    # 網站根目錄，只包含公開的檔案 (例如 index.html)
    root /usr/share/nginx/html;
    index index.html index.htm;

    # 這個 location 只會處理公開的請求
    location / {
        try_files $uri $uri/ =404;
    }

    # 【！！！新增區塊！！！】
    # 這個 location 只給內部服務 (例如後端) 使用
    # 它讓 http://frontend/goodhacker/flag.txt 這樣的內部請求可以成功
    location /goodhacker/ {
        alias /goodhacker/;
    }

    # API 反向代理的設定保持不變
    location /api/ {
        proxy_pass http://backend:5000/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
